[
  {
    "_id": "canopsis_version",
    "edition": "cat",
    "stack": "go",
    "version": "3.42.0"
  },
  {
    "_id": "user_interface",
    "app_title": "Canopsis Test",
    "login_page_description": "Test login",
    "loader_no_update": true,
    "footer": "Test footer",
    "language": "en",
    "max_matched_items": 4,
    "check_count_request_timeout": 30
  },
  {
    "_id": "global_config",
    "alarm": {
      "stealthyinterval": 0,
      "enablelasteventdate": true,
      "cancelautosolvedelay": "1h",
      "displaynamescheme": "{{ rand_string 3 }}-{{ rand_string 3 }}-{{ rand_string 3 }}",
      "outputlength": 255,
      "longoutputlength": 1024,
      "allowdoubleack": true
    },
    "global": {
      "prefetchcount": 10000,
      "prefetchsize": 0
    },
    "timezone": {
      "timezone": "Europe/Paris"
    },
    "file": {
      "remediation": "/tmp/canopsis/remediation",
      "junit": "/tmp/canopsis/junit",
      "junitapi": "/tmp/canopsis/junitapi"
    },
    "api": {
      "tokenexpiration": "24h",
      "tokensigningmethod": "HS256",
      "bulkmaxsize": 10000,
      "exportbulksize": 5000
    },
    "metrics": {
      "flushinterval": "1s",
      "sliinterval": "1h"
    }
  },
  {
    "_id": "remediation",
    "external_api": {
      "awx": {
        "auth": {
          "type": "bearer-token"
        },
        "launch_endpoint": {
          "url_tpl": "{{ .host }}/api/v2/job_templates/{{ .jobID }}/launch/",
          "method": "POST",
          "headers": {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          "response_status_url_key": "url"
        },
        "status_endpoint": {
          "url_tpl": "{{ .host }}{{ .responseUrl }}",
          "method": "GET",
          "headers": {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          "response_id_key": "id",
          "response_status_key": "status",
          "statuses": {
            "waiting": "running",
            "successful": "succeeded",
            "failed": "failed",
            "canceled": "aborted",
            "pending": "running",
            "running": "running"
          }
        },
        "output_endpoint": {
          "url_tpl": "{{ .host }}/api/v2/jobs/{{ .executionID }}/stdout",
          "method": "GET",
          "headers": {
            "Accept": "text/plain"
          }
        },
        "response_err_msg_key": "detail"
      },
      "jenkins": {
        "auth": {
          "type": "basic-auth"
        },
        "launch_endpoint": {
          "url_tpl": "{{ .host }}/job/{{ .jobID }}/build",
          "url_tpl_with_params": "{{ .host }}/job/{{ .jobID }}/buildWithParameters",
          "method": "POST",
          "headers": {
            "Accept": "application/json"
          },
          "response_status_header_url_key": "Location"
        },
        "status_endpoint": {
          "url_tpl": "{{ .host }}{{ .responseUrl }}/api/json",
          "method": "GET",
          "response_id_key": "id",
          "response_status_key": "result",
          "statuses": {
            "PASSED": "failed",
            "REGRESSION": "failed",
            "ABORTED": "aborted",
            "SUCCESS": "succeeded",
            "FAIL": "failed",
            "ERROR": "failed",
            "FIXED": "failed"
          }
        },
        "queue_endpoint": {
          "url_tpl": "{{ .host }}{{ .responseUrl }}/api/json",
          "method": "GET",
          "response_status_url_key": "executable.url"
        },
        "output_endpoint": {
          "url_tpl": "{{ .host }}/job/{{ .jobID }}/{{ .executionID }}/consoleText",
          "method": "GET"
        },
        "response_err_msg_key": "message"
      },
      "rundeck": {
        "auth": {
          "type": "header-token",
          "header": "X-Rundeck-Auth-Token"
        },
        "launch_endpoint": {
          "url_tpl": "{{ .host }}/api/35/job/{{ .jobID }}/run",
          "method": "POST",
          "headers": {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          "response_status_url_key": "href",
          "response_external_url_key": "permalink"
        },
        "status_endpoint": {
          "url_tpl": "{{ .host }}{{ .responseUrl }}",
          "method": "GET",
          "headers": {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          "response_id_key": "id",
          "response_status_key": "status",
          "statuses": {
            "aborted": "aborted",
            "running": "running",
            "succeeded": "succeeded",
            "failed": "failed"
          }
        },
        "output_endpoint": {
          "url_tpl": "{{ .host }}/api/35/execution/{{ .executionID }}/output",
          "method": "GET",
          "headers": {
            "Accept": "text/plain"
          }
        },
        "response_err_msg_key": "message"
      }
    },
    "http_timeout": "1m",
    "launch_job_retries_amount": 1,
    "launch_job_retries_interval": "1s",
    "wait_job_complete_retries_amount": 1,
    "wait_job_complete_retries_interval": "1s",
    "pause_manual_instruction_interval": "30m"
  },
  {
    "_id": "health_check",
    "engine_order": [
      {
        "from": "engine-fifo",
        "to": "engine-che"
      },
      {
        "from": "engine-che",
        "to": "engine-pbehavior"
      },
      {
        "from": "engine-pbehavior",
        "to": "engine-axe"
      },
      {
        "from": "engine-axe",
        "to": "engine-correlation"
      },
      {
        "from": "engine-axe",
        "to": "engine-remediation"
      },
      {
        "from": "engine-correlation",
        "to": "engine-service"
      },
      {
        "from": "engine-service",
        "to": "engine-dynamic-infos"
      },
      {
        "from": "engine-dynamic-infos",
        "to": "engine-action"
      },
      {
        "from": "engine-action",
        "to": "engine-webhook"
      }
    ]
  }
]
