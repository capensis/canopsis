<template lang="pug">
  top-bar-menu(:title="$t('common.exploitation')", :links="exploitationLinks")
</template>

<script>
import { sortBy } from 'lodash';

import { USERS_PERMISSIONS } from '@/constants';

import { authMixin } from '@/mixins/auth';
import entitiesInfoMixin from '@/mixins/entities/info';

import TopBarMenu from './top-bar-menu.vue';

export default {
  components: { TopBarMenu },
  mixins: [authMixin, entitiesInfoMixin],
  computed: {
    exploitationLinks() {
      const links = [
        {
          route: { name: 'exploitation-dynamic-infos' },
          title: this.$t('common.dynamicInfo'),
          icon: 'assignment',
          permission: USERS_PERMISSIONS.technical.exploitation.dynamicInfo,
        },
        {
          route: { name: 'exploitation-event-filter' },
          title: this.$t('eventFilter.title'),
          icon: 'policy',
          permission: USERS_PERMISSIONS.technical.exploitation.eventFilter,
        },
        {
          route: { name: 'exploitation-heartbeats' },
          title: this.$t('heartbeat.title'),
          icon: 'favorite',
          permission: USERS_PERMISSIONS.technical.exploitation.heartbeat,
        },
        {
          route: { name: 'exploitation-meta-alarm-rules' },
          title: this.$t('common.metaAlarmRule'),
          icon: '$vuetify.icons.insights',
          permission: USERS_PERMISSIONS.technical.exploitation.metaAlarmRule,
        },
        {
          route: { name: 'exploitation-pbehaviors' },
          title: this.$t('common.pbehaviors'),
          icon: 'pause',
          permission: USERS_PERMISSIONS.technical.exploitation.pbehavior,
        },
        {
          route: { name: 'exploitation-scenarios' },
          title: this.$t('scenario.title'),
          icon: '$vuetify.icons.miscellaneous_services',
          permission: USERS_PERMISSIONS.technical.exploitation.scenario,
        },
        {
          route: { name: 'exploitation-snmp-rules' },
          title: this.$t('snmpRules.title'),
          icon: 'approval',
          permission: USERS_PERMISSIONS.technical.exploitation.snmpRule,
        },
        {
          route: { name: 'idle-rules' },
          title: this.$t('common.idleRules'),
          icon: '$vuetify.icons.published_with_changes',
          permission: USERS_PERMISSIONS.technical.exploitation.idleRules,
        },
      ];

      const filteredLinks = links.filter(({ permission }) =>
        this.checkAppInfoAccessByPermission(permission) && this.checkReadAccess(permission));

      return sortBy(filteredLinks, 'title');
    },
  },
};
</script>
