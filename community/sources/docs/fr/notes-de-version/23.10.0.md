# Notes de version Canopsis 23.10.0

Canopsis 23.10.0 a été publié le 31 octobre 2023.

## Procédure d'installation

Suivre la [procédure d'installation de Canopsis](../guide-administration/installation/index.md).

## Procédure de mise à jour

Canopsis 23.10.0 apporte des changements importants tant au niveau technique que fonctionnel. À ce titre, le [Guide de migration vers Canopsis 23.10.0](migration/migration-23.10.0.md) doit obligatoirement être suivi pour les mises à jour d'installations déjà en place.

## Changements entre Canopsis 23.04 et 23.10

### Environnement SNMP

Le moteur SNMP a été migré de Python 2 vers Python 3. 
Certains changements de configurations sont nécessaires pour que l'ensemble de la pile SNMP reste fonctionnel.  
Le [guide de migration](migration/migration-23.10.0.md) vous indique les changements à effectuer.

Voici les différents liens de documentations associés :

* [Règles SNMP](../guide-utilisation/menu-exploitation/regles-snmp/)
* [Connecteur snmp2canopsis](../interconnexions/Supervision/SNMPtrap/)

### Tags

La version [23.04](./23.04.0.md) a introduit une première version de gestion des tags à partir des événements.  
Canopsis 23.10 introduit une gestion interne des tags.  
La [documentation associée](../../guide-utilisation/menu-administration/gestion-des-tags.md) fournit toutes les explications nécessaires à leur mise en oeuvre.


### Fonctionnalité Thèmes

Canopsis 23.04 introduit la notion de thème graphique.  
Les thèmes sont liés aux utilisateurs, qui choisissent celui qu'ils souhaitent appliquer.

![theme](./img/23.04.0-theme.png)

La version Canopsis 23.10 permet à présent de créer ses propres thèmes.  
Elle propose à l'utilisateur d'agir sur les paramètres qui concernent : 

* Principaux éléments du produit

![theme1](./img/23.10.0-theme1.png)

* Paramètres de taille de police

![theme2](./img/23.10.0-theme2.png)

* Paramètres du bac à alarmes

![theme3](./img/23.10.0-theme3.png)

* Couleurs de criticités

![theme4](./img/23.10.0-theme4.png)


### Mode Maintenance

Lorsque vous opérez une mise à jour de Canopsis ou une maintenance sur des composants de Canopsis, vous disposez à présent d'un "mode maintenance".  
Celui-ci permet de déconnecter tous les utilisateurs présents sur la plate-forme pour garantir qu'il n'y ait pas de perturbation pendant l'intervention.  

![maintenance1](./img/23.10.0-maintenance1.png)

![maintenance2](./img/23.10.0-maintenance2.png)

La [documentation](../../guide-utilisation/menu-administration/mode-maintenance/) vous donne tous les détails.

### Rafraîchissement des alarmes

Une nouvelle option du bac à alarmes permet de rafraîchir les alarmes qui sont actuellement présentées sur un bac sans intervention.  
Seules les alarmes qui sont affichées sur le bac sont raffraîchies

!!! warning "Information importante"
    Si la mise à jour d'une alarme l'exclut du filtre en cours, l'alarme sera tout de même mise à jour mais ne disparaitra du filtre qu'après le rafraîchissement périodique paramétré ou manuel.


### Montées de version 

Les outils suivants bénéficient de mises à jour :

| Outil       | Version d'origine | Version après 23.04 |
| ----------- | ----------------- | ------------------- |
| RabbitMQ    | 3.11              | 3.12                |
| NodeJS      | 16                | 20                  |

Les instructions pour leur mise à jour sont précisées dans le [guide de migration](migration/migration-23.10.0.md).

### Liste des modifications

*  **UI :**
    * Amélioration de la fonction de vérification des patterns (#4641)
    * Correction d'un bug qui empêchait de positionner une image sur la mire de connexion (#4948)
    * Désactivation de la possibilité de changer le type d'une consigne (#5048) 
    * **Bac à alarmes**
        * La sélection des colonnes se fait à présent de manière plus ergonomique et autorise le drag'n drop (#4872)
        * Correction d'un bug qui empêchait la déclaration de tickets en masse (#5069)
        * Lorsqu'un lien est présent dans les colonnes `output`, `longOutput`, `initialOutput`, ou `initialLongOutput`, il est directement interprété comme tel (#5036)
        * Ajout de la possibilité d'annuler l'annulation d'une alarme (#4971)
        * Ajout d'une option permettant de rafraîchir les alarmes présentes dans le bac sans intervention (#4473)
*  **API :**
        * Seconde partie de correction d'un bug qui entrainait un calcul de durée d'alarme négatif (#5001)
        * Ajout d'un trigger capable de se déclencher après la réception de x événements sur une alarme (#5024)
        * Les variables d'environnement peuvent maintenant être exploitées dans Canopsis (#4946)
        * Correction d'un bug qui empechait l'export de statistiques de remédiation en cas d'absence de métrique (#5072)
*  **Moteurs :**
    * **AXE**
        * Seconde partie de correction d'un bug qui entrainait un calcul de durée d'alarme négatif (#5001)
        * Correction d'un bug de calcul de compteurs de services lorsque le débit d'événements est très élevé (#5050)
    * **Remediation**
        * Correction d'un bug qui générait une erreur 500 avec le message "runtime error: invalid memory address or nil pointer dereference" (#5046)
        * Correction d'un bug qui générait une erreur 500 avec le message "(Location4568) Total size of documents in job_history matching pipeline's $lookup stage exceeds 104857600 bytes" (#5057)
*  **Connecteurs :**
*  **Templates GO :**
*  **Général :**
    * Le service `migrate-metrics-meta` ne fait plus partie des configurations de référence de Canopsis (#5067)
*  **Documentation :**
    * [Règles SNMP](../guide-utilisation/menu-exploitation/regles-snmp/)
    * [Connecteur snmp2canopsis](../interconnexions/Supervision/SNMPtrap/)
    * [Gestion des tags](../../guide-utilisation/menu-administration/gestion-des-tags.md)
    * [Mode maintenance](../../guide-utilisation/menu-administration/mode-maintenance/) 
