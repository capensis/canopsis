# Notes de version Canopsis 3.32.0

Canopsis 3.32.0 a été publié le 8 novembre 2019.

## Procédure de mise à jour

Suivre la [procédure standard de mise à jour de Canopsis](../guide-administration/mise-a-jour/index.md).

### Migration des statistiques du moteur `engine-stat` Go

Le moteur Go `engine-stat` (à ne pas confondre avec le moteur Python `statsng`) n'est plus maintenu et n'est plus activé dans les nouvelles installations, depuis [Canopsis 3.31.0](3.31.0.md).

Néanmoins, **si vous l'utilisez toujours**, vous devez vous [connecter à la base InfluxDB](../guide-administration/installation/premiere-connexion.md#influxdb) et y exécuter les requêtes suivantes :

```sql
select ok::integer,ko::integer into event_state_history_old from event_state_history group by connector,connector_name,component,resource,eid;
drop measurement event_state_history;
select ok::integer into event_state_history from event_state_history_old where ok > 0 group by connector,connector_name,component,resource,eid;
select ko::integer into event_state_history from event_state_history_old where ko > 0 group by connector,connector_name,component,resource,eid;
drop measurement event_state_history_old;
```

Notez que ces requêtes peuvent prendre plusieurs dizaines de minutes à s'exécuter.

### Variable `CPS_REDIS_URL` obligatoire en environnement Docker

En environnement Docker, les précédentes versions de Canopsis toléraient l'absence d'une variable `CPS_REDIS_URL` dans l'environnement, et utilisaient alors implicitement la valeur `redis://redis:6379/0`.

Canopsis 3.32.0 uniformise la gestion de l'URL Redis pour la rendre similaire aux autres composants (RabbitMQ, MongoDB, InfluxDB…), où cette variable est toujours obligatoire.

Vous devez donc vous assurer que les fichiers `docker-compose.yml` ou `compose.env` contiennent bien une valeur de ce type :

```sh
CPS_REDIS_URL=redis://redis:6379/0
```

Il n'y a aucune autre action à réaliser pour mettre Canopsis à jour d'une version 3.31 à une version 3.32.

## Changements entre Canopsis 3.31.0 et 3.32.0

Voir le [ChangeLog complet](https://git.canopsis.net/canopsis/canopsis/blob/develop/CHANGELOG.md) pour plus de détails techniques.

*  **Images Docker / paquets :**
*  **Documentation :**
    *  Amélioration significative des documentations [SNMP Trap](../interconnexions/Supervision/SNMPtrap.md) et [SNMP Trap Custom](../interconnexions/Supervision/SNMPtrap_custom.md) ([#1784](https://git.canopsis.net/canopsis/canopsis/issues/1784))
    *  Ajout d'une documentation sur l'option `-alwaysFlushEntities` du [moteur `che`](../guide-administration/moteurs/moteur-che.md). Cette option reste depréciée et non recommandée ([#2024](https://git.canopsis.net/canopsis/canopsis/issues/2024))
*  **Moteurs :**
    *  **Moteurs nouvelle génération (Go) :**
        *  Mise à jour de Go 1.12.9 vers [Go 1.12.12](https://golang.org/doc/devel/release.html#go1.12.minor) ([#142](https://git.canopsis.net/canopsis/go-engines/issues/142))
        *  Correction d'une *runtime error*, lors du lancement du moteur `axe` avec l'option `-featureStatEvents`. Régression introduite dans [Canopsis 3.31.0](3.31.0.md) ([#145](https://git.canopsis.net/canopsis/go-engines/issues/145))
*  **UI :**
    *  **Traductions :**
