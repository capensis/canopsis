Ember.Application.initializer({name:"AlertExpressionAdapter",after:["ApplicationAdapter"],initialize:function(e,t){var r=e.lookupFactory("adapter:application"),i=r.extend({findQuery:function(e,t){var r="/alerts/search/validate";return this.ajax(r,"GET",{data:t})}});t.register("adapter:alertexpression",i)}}),Ember.Application.initializer({name:"AlertsAdapter",after:["ApplicationAdapter"],initialize:function(e,t){var r=e.lookupFactory("adapter:application"),i=r.extend({findQuery:function(e,t){var r="/alerts/get-alarms";return this.ajax(r,"GET",{data:t})}});t.register("adapter:alerts",i)}}),Ember.Application.initializer({name:"component-alarmraw",initialize:function(e,t){var r=Ember.get,i=Ember.set,n=(Ember.isNone,Ember.Component.extend({tagName:"tr",init:function(){this._super(),i(this,"alarm",r(this,"alarm")),i(this,"fields",r(this,"fields"))},actions:{tdClick:function(e,t){this.sendAction("action",e,t)}}}));t.register("component:component-alarmraw",n)}}),Ember.Application.initializer({name:"component-alarmstate",initialize:function(e,t){var r=Ember.get,i=Ember.set,n=Ember.isNone,o=Ember.Component.extend({state:void 0,isSelected:0,init:function(){this._super(),n(this.get("content"))||i(this,"state",r(this,"content.state"))},onUpdate:function(){this.set("content",{state:r(this,"state")})}.observes("state")});t.register("component:component-alarmstate",o)}}),Ember.Application.initializer({name:"component-alarmtable",initialize:function(e,t){var r=Ember.get,i=(Ember.set,Ember.isNone,Ember.Component.extend({init:function(){this._super()},currentSortColumn:function(){return r(this,"defaultSortColumn")}.property("defaultSortColumn"),sAlarms:function(){return this.get("alarms")}.property("alarms"),actions:{click:function(e){e==this.get("currentSortColumn")?this.set("currentSortColumn.isASC",!this.get("currentSortColumn.isASC")):(this.set("currentSortColumn.isSortable",!1),this.set("currentSortColumn",e),this.set("currentSortColumn.isSortable",!0),this.set("currentSortColumn.isASC",!0)),this.sendAction("action",this.get("currentSortColumn"))},tdClick:function(e,t){Ember.columnTemplates.findBy("columnName",t.humanName)&&(this.set("clickedAlarm",e),this.set("clickedField",t),this.set("updater",(new Date).getTime()))}}}));t.register("component:component-alarmtable",i)}}),Ember.Application.initializer({name:"component-alarmtd",initialize:function(e,t){var r=Ember.get,i=(Ember.set,Ember.isNone,Ember.Component.extend({tagName:"td",renderers:["v_state_val","v_state_t","v_status_val","v_ack"],init:function(){this._super()},click:function(){this.sendAction("action",this.get("alarm"),this.get("field"))},value:function(){var e=r(this,"alarm"),t=r(this,"field");return e[t.getValue]}.property("alarm","field"),hasRenderer:function(){return this.get("renderers").includes(this.get("field.name").replace(/\./g,"_"))}.property("alarm"),renderer:function(){return this.get("field.name").replace(/\./g,"_")}.property("alarm.name")}));t.register("component:component-alarmtd",i)}}),Ember.Application.initializer({name:"component-columntemplate",initialize:function(e,t){var r=Ember.get,i=Ember.set,n=Ember.isNone,o=Ember.Component.extend({template:void 0,column:void 0,init:function(){this._super(),n(this.get("content"))||(i(this,"column",r(this,"content.column")),i(this,"template",r(this,"content.template")))},onUpdate:function(){this.set("content",{column:r(this,"column"),template:r(this,"template")})}.observes("template","column")});t.register("component:component-columntemplate",o)}}),Ember.Application.initializer({name:"component-popupinfo",initialize:function(e,t){var r=(Ember.get,Ember.set,Ember.isNone,Ember.Component.extend({init:function(){this._super(),this.set("columnTemplate",Ember.columnTemplates.findBy("columnName",this.get("columnName")).columnTemplate)},upd:function(){this.get("columnName")==this.get("clickedField.humanName")&&($(".popupinfo").hide(),console.error(this.get("columnName"),this.get("columnTemplate"),this.get("clickedField"),this.get("clickedAlarm")),this.$(".popupinfo").fadeIn(500))}.observes("updater"),actions:{hide:function(){this.$(".popupinfo").fadeOut(500)}}}));t.register("component:component-popupinfo",r)}}),Ember.Application.initializer({name:"component-rendererack",initialize:function(e,t){var r=Ember.get,i=(Ember.set,Ember.isNone,Ember.Component.extend({propertyMap:{t:"date",a:"user"},properties:["t","a"],propertiesMap:function(){var e=this.get("propertyMap"),t=this.get("value");return this.get("properties").map(function(i){return{key:e[i]||i,value:r(t,i)}})}.property("properties","propertyMap","value"),init:function(){this._super()}}));t.register("component:component-rendererack",i)}}),Ember.Application.initializer({name:"component-rendererstate",initialize:function(e,t){var r=(Ember.get,Ember.set,Ember.isNone,Ember.Component.extend({list:{0:{color:"bg-red",name:"Critical"},1:{color:"bg-yellow",name:"Minor"},2:{color:"bg-green",name:"Good"},3:{color:"bg-blue",name:"Undef"}},init:function(){this._super()},spanClass:function(){return[this.get("list")[this.get("value")].color,"badge"].join(" ")}.property("value"),caption:function(){return this.get("list")[this.get("value")].name}.property("value")}));t.register("component:component-rendererstate",r)}}),Ember.Application.initializer({name:"component-rendererstatetimestamp",initialize:function(e,t){var r=(Ember.get,Ember.set,Ember.isNone,Ember.Component.extend({init:function(){this._super()},timestamp:function(){return new Date(2017,0,30).getTime()/1e3}.property("value")}));t.register("component:component-rendererstatetimestamp",r)}}),Ember.Application.initializer({name:"component-rendererstatusval",initialize:function(e,t){var r=(Ember.get,Ember.set,Ember.isNone,Ember.Component.extend({list:{0:"undef",1:"on going",2:"undef",3:"undef",4:"cancelled"},init:function(){this._super()},status:function(){return this.get("list")[this.get("value")]}.property("value")}));t.register("component:component-rendererstatusval",r)}}),Ember.Application.initializer({name:"component-search",initialize:function(e,t){var r=(Ember.get,Ember.set,Ember.isNone,Ember.Component.extend({classNames:["pull-left","input-group","input-group-sm","col-xs-3","search","search-padding"],init:function(){this._super(),console.error(this.get("isValid"))},removeInvalidSearchTextNotification:function(){this.set("isValid",!0)}.observes("value"),actions:{search:function(){this.get("value").length>0&&this.sendAction("action",this.get("value"))},resetValue:function(){this.set("value",""),this.sendAction("action","")}}}));t.register("component:component-search",r)}}),Ember.Application.initializer({name:"RinfopopMixin",after:"MixinFactory",initialize:function(e,t){var r=e.lookupFactory("factory:mixin"),i=Ember.get,n=r("rinfopop",{actions:{sendDisplayRecord:function(e){console.log("sendDisplayRecord action called with params",e);var t=i(this,"mixinOptions.rinfopop.popup_template");Ember.isNone(t)&&(t=""),console.log("Template is ",t);var r=i(this,"controllers.rinfopop");r.send("show",e,t)}},rendererFor:function(e){var t=i(this,"mixinOptions.rinfopop.clickable_column");return console.log("recordinfopopup rendererFor",e,t),e.field===t?"renderer-recordinfopopup":this._super(e)}});t.register("mixin:rinfopop",n)}}),Ember.Application.initializer({name:"AlertExpressionSerializer",after:["ApplicationSerializer"],initialize:function(e,t){var r=e.lookupFactory("serializer:application"),i=r.extend({});t.register("serializer:alertexpression",i)}}),Ember.Application.initializer({name:"AlertsSerializer",after:["ApplicationSerializer"],initialize:function(e,t){var r=e.lookupFactory("serializer:application"),i=r.extend({});t.register("serializer:alerts",i)}}),Ember.Application.initializer({name:"ListAlarmWidget",after:["TimeWindowUtils","DataUtils","WidgetFactory","UserconfigurationMixin","RinfopopMixin","SchemasLoader","CustomfilterlistMixin","TimeWindowUtils"],initialize:function(e,t){var r=(e.lookupFactory("utility:timewindow"),e.lookupFactory("utility:data")),i=e.lookupFactory("factory:widget"),n=e.lookupFactory("mixin:userconfiguration");TimeWindowUtils=e.lookupFactory("utility:timewindow"),mx=e.lookupFactory("mixin:customfilterlist");var o=Ember.get,a=Ember.set,s=(Ember.isNone,{mixins:[n,mx]}),l=i("listalarm",{viewMixins:[],searchText:"",isValidSearchText:!0,humanReadableColumnNames:{uid:"_id",connector:"v.connector",connector_name:"v.connector_name",component:"v.component",resource:"v.resource",entity_id:"d",state:"v.state.val",status:"v.status.val",snooze:"v.snooze",ack:"v.ack",cancel:"v.cancel","ticket.val":"v.ticket.val",output:"output",opened:"t",resolved:"v.resolved",domain:"v.extra.domain",perimeter:"v.extra.perimeter",last_state_change:"v.state.t",output:"v.state.m"},alarmss:function(){this.set("loaded",!1);var e=this.get("alarmSearchOptions");console.error("reload original alarms with params",e);var t=r.getEmberApplicationSingleton().__container__.lookup("adapter:alerts");return DS.PromiseArray.create({promise:t.findQuery("alerts",e).then(function(e){if(e.success)return console.error("loaded alarms: ",o(e,"data.firstObject.alarms")),Ember.totalAlarms=o(e,"data.firstObject.total"),o(e,"data.firstObject.alarms");throw new Error(o(e,"data.msg"))},function(e){return console.error("ERROR in the adapter: ",e),[]}).catch(function(e){return console.error("unexpected error ",e),[]})})}.property("alarmSearchOptions.search","alarmSearchOptions.tstart","alarmSearchOptions.tstop","alarmSearchOptions.resolved","alarmSearchOptions.sort_key","alarmSearchOptions.sort_dir","alarmSearchOptions.filter","alarmSearchOptions.skip","alarmSearchOptions.limit"),fields:function(){return this.parseFields(o(this,"model.columns"))}.property("model.columns"),widgetDataMetas:function(){return{total:this.get("defTotal")||0}}.property("defTotal"),alarms:function(){var e=o(this,"fields"),t=o(this,"alarmss").map(function(t){var r={};return e.forEach(function(e){var i=o(Ember.Object.create(t),e.getValue);r[e.name]=i,r[e.humanName]=i}),r});return this.set("defTotal",Ember.totalAlarms),this.set("loaded",!0),t}.property("alarmss.@each","fields.[]"),currPage:function(){this.set("alarmSearchOptions.limit",this.get("itemsPerPage")),this.set("alarmSearchOptions.skip",this.get("itemsPerPage")*(this.get("currentPage")-1)),console.error("current page",this.get("currentPage")),console.error("itemsPerPage",this.get("itemsPerPage"))}.observes("currentPage","itemsPerPage"),paginationLastItemIndexx:function(){var e=o(this,"itemsPerPage"),t=e*(this.currentPage-1);return Math.min(t+e,o(this,"itemsTotal"))}.property("widgetData","itemsTotal","itemsPerPage","currentPage"),filtersObserver:function(){var e=this.get("user_filters").findBy("isActive",!0);e?(console.error(e.filter||e.get("filter")),this.set("alarmSearchOptions.filter",e.filter||e.get("filter"))):(console.error("there is no filter"),this.set("alarmSearchOptions.filter",void 0))}.observes("user_filters.@each.isActive"),init:function(){this._super.apply(this,arguments),a(this,"loaded",!1),a(this,"rights",{list_filters:{checksum:!0}}),a(this,"store",DS.Store.extend({container:o(this,"container")})),this.showParams(),this.loadRadioButtonView(),this.loadTemplates(this.get("model.popup"));var e=this.get("user_filters").findBy("isActive",!0),t=e?e.filter:void 0,r=this.get("model.alarms_state_filter.state")||"opened";this.set("alarmSearchOptions",{tstart:0,tstop:0,opened:"opened"==r,resolved:"resolved"==r,filter:t,search:"",sort_key:this.get("model.default_sort_column.property"),sort_dir:this.get("model.default_sort_column.direction"),skip:0,limit:this.get("model.itemsPerPage")||50})},loadRadioButtonView:function(){view=Ember.View.extend({tagName:"input",type:"radio",attributeBindings:["name","type","value","checked:checked:"],click:function(){console.error(this),this.set("selection",this.$().val())},checked:function(){return this.get("value")==this.get("selection")}.property()});try{Ember.RadioButton||(Ember.RadioButton=view)}catch(e){}},loadTemplates:function(e){Ember.columnTemplates=e.map(function(e){return{columnName:e.column,columnTemplate:Ember.View.extend({template:Ember.HTMLBars.compile(e.template)})}})},showParams:function(){var e=this,t=["popup","title"];console.error("brick's parameters"),t.forEach(function(t){console.error(t+": "+e.get("model."+t))}),console.error("default_sort_column: "+e.get("model.default_sort_column.property")+"-"+e.get("model.default_sort_column.direction")),console.error("columnts: "+e.get("model.columns").join(" ")),console.error("alarms_state_filter: "+e.get("model.alarms_state_filter.state"))},refreshContent:function(){},fetchAlarms:function(e){var t=this,i=e||{},n=this.get("model.alarms_state_filter.state")||"opened",a={tstart:i.tstart||0,tstop:i.tstop||0,sort_key:i.sort_key||this.get("model.default_sort_column.property"),sort_dir:i.sort_dir||this.get("model.default_sort_column.direction"),search:i.search||"",opened:"opened"==n,resolved:"resolved"==n},s=r.getEmberApplicationSingleton().__container__.lookup("adapter:alerts");s.findQuery("alerts",a).then(function(e){var r=o(e,"data");t.setAlarmsForShow(r[0].alarms),console.error("alerts::",r)},function(e){})},isValidExpression:function(e){var t={expression:e},i=r.getEmberApplicationSingleton().__container__.lookup("adapter:alertexpression");return DS.PromiseObject.create({promise:i.findQuery("alertexpression",t).then(function(e){if(e.success)return console.error(e.data[0]),e.data[0];throw new Error(e.data.msg)},function(e){return console.error("ERROR in the adapter: ",e),!1}).catch(function(e){return console.error("unexpected error ",e),!1})})},parseFields:function(e){var t=this,r=[],i=this.get("model.default_sort_column.property"),n=this.get("model.default_sort_column.direction");return r=e.map(function(e){var r={};return r.name=t.get("humanReadableColumnNames")[e]||"v."+e,r.humanName=e,r.isSortable=e==i,r.isASC="ASC"==n,r.getValue=t.get("humanReadableColumnNames")[e]||"v."+e,r})},sortColumn:function(){var e=o(this,"fields").findBy("humanName",o(this,"controller.default_sort_column.property"));if(!e){e=o(this,"fields.firstObject");try{e.isSortable=!0,e.isASC=o(this,"controller.default_sort_column.property")}catch(e){console.error("alarm!!!")}return console.error('the column "'+o(this,"controller.default_sort_column.property")+'" was not found.'),e}return e}.property("controller.default_sort_column.property","fields.[]"),actions:{updateSortField:function(e){this.set("alarmSearchOptions.sort_key",e.name),this.set("alarmSearchOptions.sort_dir",e.isASC?"ASC":"DESC")},search:function(e){var t=this;console.error("search ",e),this.isValidExpression(e).then(function(r){t.set("isValidSearchText",r),r&&t.set("alarmSearchOptions.search",e)})}}},s);t.register("widget:listalarm",l)}});
//# sourceMappingURL=dist/brick.map.js