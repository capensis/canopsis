Ember.Application.initializer({name:"AlertExpressionAdapter",after:["ApplicationAdapter"],initialize:function(e,t){var i=e.lookupFactory("adapter:application"),n=i.extend({findQuery:function(e,t){var i="/alerts/search/validate";return this.ajax(i,"GET",{data:t})}});t.register("adapter:alertexpression",n)}}),Ember.Application.initializer({name:"AlertsAdapter",after:["ApplicationAdapter"],initialize:function(e,t){var i=e.lookupFactory("adapter:application"),n=i.extend({findQuery:function(e,t){var i="/alerts/get-alarms";return this.ajax(i,"GET",{data:t})}});t.register("adapter:alerts",n)}}),Ember.Application.initializer({name:"component-alarmraw",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=(Ember.isNone,Ember.Component.extend({tagName:"tr",init:function(){this._super(),n(this,"alarm",i(this,"alarm")),n(this,"fields",i(this,"fields"))},actions:{tdClick:function(e,t){this.sendAction("action",e,t)}}}));t.register("component:component-alarmraw",o)}}),Ember.Application.initializer({name:"component-alarmstate",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.Component.extend({state:void 0,isSelected:0,init:function(){this._super(),o(this.get("content"))||n(this,"state",i(this,"content.state"))},onUpdate:function(){this.set("content",{state:i(this,"state")})}.observes("state")});t.register("component:component-alarmstate",r)}}),Ember.Application.initializer({name:"component-alarmtable",initialize:function(e,t){var i=Ember.get,n=(Ember.set,Ember.isNone,Ember.Component.extend({init:function(){this._super()},currentSortColumn:function(){return i(this,"defaultSortColumn")}.property("defaultSortColumn"),sAlarms:function(){return this.get("alarms")}.property("alarms"),actions:{click:function(e){e==this.get("currentSortColumn")?this.set("currentSortColumn.isASC",!this.get("currentSortColumn.isASC")):(this.set("currentSortColumn.isSortable",!1),this.set("currentSortColumn",e),this.set("currentSortColumn.isSortable",!0),this.set("currentSortColumn.isASC",!0)),this.sendAction("action",this.get("currentSortColumn"))},tdClick:function(e,t){Ember.columnTemplates.findBy("columnName",t.name)&&(this.set("clickedAlarm",e),this.set("clickedField",t),this.set("updater",(new Date).getTime()))}}}));t.register("component:component-alarmtable",n)}}),Ember.Application.initializer({name:"component-alarmtd",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=(Ember.isNone,Ember.Component.extend({tagName:"td",init:function(){this._super(),n(this,"alarm",i(this,"alarm")),n(this,"field",i(this,"field"))},click:function(){this.sendAction("action",this.get("alarm"),this.get("field"))},value:function(){var e=i(this,"alarm"),t=i(this,"field");return i(e,t.name)}.property("alarm","field")}));t.register("component:component-alarmtd",o)}}),Ember.Application.initializer({name:"component-columntemplate",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.Component.extend({template:void 0,column:void 0,init:function(){this._super(),o(this.get("content"))||(n(this,"column",i(this,"content.column")),n(this,"template",i(this,"content.template")))},onUpdate:function(){this.set("content",{column:i(this,"column"),template:i(this,"template")})}.observes("template","column")});t.register("component:component-columntemplate",r)}}),Ember.Application.initializer({name:"component-popupinfo",initialize:function(e,t){var i=(Ember.get,Ember.set,Ember.isNone,Ember.Component.extend({init:function(){this._super(),this.set("columnTemplate",Ember.columnTemplates.findBy("columnName",this.get("columnName")).columnTemplate)},upd:function(){this.get("columnName")==this.get("clickedField.name")&&($(".popupinfo").hide(),console.error(this.get("columnName"),this.get("columnTemplate"),this.get("clickedField"),this.get("clickedAlarm")),this.$(".popupinfo").fadeIn(500))}.observes("updater"),actions:{hide:function(){this.$(".popupinfo").fadeOut(500)}}}));t.register("component:component-popupinfo",i)}}),Ember.Application.initializer({name:"component-search",initialize:function(e,t){var i=(Ember.get,Ember.set,Ember.isNone,Ember.Component.extend({init:function(){this._super(),console.error(this.get("isValid"))},removeInvalidSearchTextNotification:function(){this.set("isValid",!0)}.observes("value"),actions:{search:function(){this.get("value").length>0&&this.sendAction("action",this.get("value"))},resetValue:function(){this.set("value",""),this.sendAction("action","")}}}));t.register("component:component-search",i)}}),Ember.Application.initializer({name:"RinfopopMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=i("rinfopop",{actions:{sendDisplayRecord:function(e){console.log("sendDisplayRecord action called with params",e);var t=n(this,"mixinOptions.rinfopop.popup_template");Ember.isNone(t)&&(t=""),console.log("Template is ",t);var i=n(this,"controllers.rinfopop");i.send("show",e,t)}},rendererFor:function(e){var t=n(this,"mixinOptions.rinfopop.clickable_column");return console.log("recordinfopopup rendererFor",e,t),e.field===t?"renderer-recordinfopopup":this._super(e)}});t.register("mixin:rinfopop",o)}}),Ember.Application.initializer({name:"AlertExpressionSerializer",after:["ApplicationSerializer"],initialize:function(e,t){var i=e.lookupFactory("serializer:application"),n=i.extend({});t.register("serializer:alertexpression",n)}}),Ember.Application.initializer({name:"AlertsSerializer",after:["ApplicationSerializer"],initialize:function(e,t){var i=e.lookupFactory("serializer:application"),n=i.extend({});t.register("serializer:alerts",n)}}),Ember.Application.initializer({name:"ListAlarmWidget",after:["TimeWindowUtils","DataUtils","WidgetFactory","UserconfigurationMixin","RinfopopMixin","SchemasLoader"],initialize:function(e,t){var i=(e.lookupFactory("utility:timewindow"),e.lookupFactory("utility:data")),n=e.lookupFactory("factory:widget"),o=e.lookupFactory("mixin:userconfiguration"),r=Ember.get,a=Ember.set,s=(Ember.isNone,{mixins:[o]}),l=n("listalarm",{viewMixins:[],searchText:"",isValidSearchText:!0,init:function(){this._super.apply(this,arguments),this.fetchAlarms(),a(this,"store",DS.Store.extend({container:r(this,"container")})),this.showParams(),this.setFields(),this.loadTemplates(this.get("model.popup")),this.loadRadioButtonView()},loadRadioButtonView:function(){view=Ember.View.extend({tagName:"input",type:"radio",attributeBindings:["name","type","value","checked:checked:"],click:function(){console.error(this),this.set("selection",this.$().val())},checked:function(){return this.get("value")==this.get("selection")}.property()}),Ember.RadioButton.set(view)},loadTemplates:function(e){Ember.columnTemplates=e.map(function(e){return{columnName:e.column,columnTemplate:Ember.View.extend({template:Ember.HTMLBars.compile(e.template)})}})},showParams:function(){var e=this,t=["popup","title"];console.error("brick's parameters"),t.forEach(function(t){console.error(t+": "+e.get("model."+t))}),console.error("default_sort_column: "+e.get("model.default_sort_column.property")+"-"+e.get("model.default_sort_column.direction")),console.error("columnts: "+e.get("model.columns").join(" ")),console.error("alarms_state_filter: "+e.get("model.alarms_state_filter.state"))},refreshContent:function(){},fetchAlarms:function(e){var t=this,n=e||{},o=this.get("model.alarms_state_filter.state")||"opened",a={tstart:n.tstart||0,tstop:n.tstop||0,sort_key:n.sort_key||this.get("model.default_sort_column.property"),sort_dir:n.sort_dir||this.get("model.default_sort_column.direction"),search:n.search||"",opened:"opened"==o,resolved:"resolved"==o},s=i.getEmberApplicationSingleton().__container__.lookup("adapter:alerts");s.findQuery("alerts",a).then(function(e){var i=r(e,"data");t.setAlarmsForShow(i[0].alarms),console.error("alerts::",i)},function(e){})},isValidExpression:function(e){var t=this,n={expression:e},o=i.getEmberApplicationSingleton().__container__.lookup("adapter:alertexpression");o.findQuery("alertexpression",n).then(function(i){var i=r(i,"data");if(console.error("alertexpression result",i),t.set("isValidSearchText",i[0]),i[0]){var n={};n.search=e,t.fetchAlarms(n)}},function(e){console.error("ERROR in the adapter: ",e)})},setFields:function(){this.set("fields",this.parseFields(r(this,"model.columns")))},setAlarmsForShow:function(e){var t=r(this,"fields"),i=e.map(function(e){var i={};return t.forEach(function(t){i[t.name]=r(Ember.Object.create(e),"v."+t.getValue)}),i});this.set("alarms",i)},parseFields:function(e){var t=["state","status"],i=[],n=this.get("model.default_sort_column.property"),o=this.get("model.default_sort_column.direction");return i=e.map(function(e){var i={};return i.name=e,i.isSortable=e==n,i.isASC="ASC"==o,t.includes(e)?i.getValue=e+".val":i.getValue=e,i})},sortColumn:function(){var e=r(this,"fields").findBy("name",r(this,"controller.default_sort_column.property"));return e?e:(e=r(this,"fields.firstObject"),e.isSortable=!0,e.isASC=r(this,"controller.default_sort_column.property"),console.error('the column "'+r(this,"controller.default_sort_column.property")+'" was not found.'),e)}.property("controller.default_sort_column.property","fields.[]"),actions:{updateSortField:function(e){var t={};t.sort_key=e.name,t.sort_dir=e.isASC?"ASC":"DESC",this.fetchAlarms(t)},search:function(e){console.error("search",e),this.isValidExpression(e)}}},s);t.register("widget:listalarm",l)}});
//# sourceMappingURL=dist/brick.map.js